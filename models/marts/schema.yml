version: 2

models:
  - name: dim_users
    description: "Customer dimension with behavioral and financial metrics"
    columns:
      - name: user_id
        description: "Unique user identifier"
        tests:
          - unique
          - not_null
      - name: customer_segment
        description: "Customer segmentation (VIP, Loyal, Regular, One-time, Prospect)"
      - name: recency_status
        description: "Recency classification (Active, At Risk, Inactive, Lost)"
      - name: total_revenue
        description: "Total revenue generated by customer"
      - name: customer_score
        description: "Composite score (0-100) based on segment, recency, returns, and AOV"
      - name: is_repeat_customer
        description: "Boolean flag for customers with multiple orders"

  - name: dim_products
    description: "Product dimension with sales performance metrics"
    columns:
      - name: product_id
        description: "Unique product identifier"
        tests:
          - unique
          - not_null
      - name: performance_category
        description: "Product performance tier (Star, Rising Star, Steady Performer, etc.)"
      - name: activity_status
        description: "Product activity status (Active, Declining, Inactive, Discontinued)"
      - name: product_score
        description: "Composite product performance score (0-100)"
      - name: total_profit
        description: "Total profit generated by product"
      - name: return_rate_pct
        description: "Percentage of units returned"

  - name: fact_sales
    description: "Sales fact table with all transactional data and dimensional context"
    columns:
      - name: order_item_id
        description: "Unique identifier for each order item"
        tests:
          - unique
          - not_null
      - name: sale_price
        description: "Actual sale price of the item"
        tests:
          - not_null
      - name: gross_profit
        description: "Profit on this transaction (sale_price - cost)"
      - name: gross_margin_pct
        description: "Gross margin percentage"
      - name: discount_amount
        description: "Discount amount (retail_price - sale_price)"
      - name: discount_pct
        description: "Discount percentage from retail price"
      - name: is_profitable
        description: "Boolean flag indicating if transaction was profitable"
      - name: transaction_value_tier
        description: "Value tier of the transaction"
      - name: season
        description: "Season when transaction occurred"